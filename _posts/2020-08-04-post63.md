---
layout: post
title:  "[BOJ 3176]"
date:   2020-08-04
excerpt: "도로 네트워크"
categories: PS
image: "/images/3176.png"
sitemap :
  changefreq : weekly
  priority : 1.0
---
문제 바로가기 : [https://www.acmicpc.net/problem/3176](https://www.acmicpc.net/problem/3176)<br>
문제 설명은 위 링크에서 확인해주시길 바랍니다.
<br>
## Solution
<div class="colorscripter-code" style="color:#F1F2F3;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#22282A;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #4f4f4f"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#aaa;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div><div style="line-height:130%">30</div><div style="line-height:130%">31</div><div style="line-height:130%">32</div><div style="line-height:130%">33</div><div style="line-height:130%">34</div><div style="line-height:130%">35</div><div style="line-height:130%">36</div><div style="line-height:130%">37</div><div style="line-height:130%">38</div><div style="line-height:130%">39</div><div style="line-height:130%">40</div><div style="line-height:130%">41</div><div style="line-height:130%">42</div><div style="line-height:130%">43</div><div style="line-height:130%">44</div><div style="line-height:130%">45</div><div style="line-height:130%">46</div><div style="line-height:130%">47</div><div style="line-height:130%">48</div><div style="line-height:130%">49</div><div style="line-height:130%">50</div><div style="line-height:130%">51</div><div style="line-height:130%">52</div><div style="line-height:130%">53</div><div style="line-height:130%">54</div><div style="line-height:130%">55</div><div style="line-height:130%">56</div><div style="line-height:130%">57</div><div style="line-height:130%">58</div><div style="line-height:130%">59</div><div style="line-height:130%">60</div><div style="line-height:130%">61</div><div style="line-height:130%">62</div><div style="line-height:130%">63</div><div style="line-height:130%">64</div><div style="line-height:130%">65</div><div style="line-height:130%">66</div><div style="line-height:130%">67</div><div style="line-height:130%">68</div><div style="line-height:130%">69</div><div style="line-height:130%">70</div><div style="line-height:130%">71</div><div style="line-height:130%">72</div><div style="line-height:130%">73</div><div style="line-height:130%">74</div><div style="line-height:130%">75</div><div style="line-height:130%">76</div><div style="line-height:130%">77</div><div style="line-height:130%">78</div><div style="line-height:130%">79</div><div style="line-height:130%">80</div><div style="line-height:130%">81</div><div style="line-height:130%">82</div><div style="line-height:130%">83</div><div style="line-height:130%">84</div><div style="line-height:130%">85</div><div style="line-height:130%">86</div><div style="line-height:130%">87</div><div style="line-height:130%">88</div><div style="line-height:130%">89</div><div style="line-height:130%">90</div><div style="line-height:130%">91</div><div style="line-height:130%">92</div><div style="line-height:130%">93</div><div style="line-height:130%">94</div><div style="line-height:130%">95</div><div style="line-height:130%">96</div><div style="line-height:130%">97</div><div style="line-height:130%">98</div><div style="line-height:130%">99</div><div style="line-height:130%">100</div><div style="line-height:130%">101</div><div style="line-height:130%">102</div><div style="line-height:130%">103</div><div style="line-height:130%">104</div><div style="line-height:130%">105</div><div style="line-height:130%">106</div><div style="line-height:130%">107</div><div style="line-height:130%">108</div><div style="line-height:130%">109</div><div style="line-height:130%">110</div><div style="line-height:130%">111</div><div style="line-height:130%">112</div><div style="line-height:130%">113</div><div style="line-height:130%">114</div><div style="line-height:130%">115</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#F1F2F3;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#919191">//3176</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">#include&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>iostream<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">#include&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>string<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">#include&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>cstring<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">#include&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>cstdio<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">#include&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>vector<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">using&nbsp;namespace&nbsp;std;</div><div style="padding:0 6px; white-space:pre; line-height:130%">#define&nbsp;INF&nbsp;<span style="color:#FFCD22">987654321</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">#define&nbsp;MAXSIZE&nbsp;<span style="color:#FFCD22">100001</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">#define&nbsp;COL&nbsp;<span style="color:#FFCD22">20</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">struct&nbsp;pv&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;p,&nbsp;v;</div><div style="padding:0 6px; white-space:pre; line-height:130%">};</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">typedef&nbsp;long&nbsp;long&nbsp;ll;</div><div style="padding:0 6px; white-space:pre; line-height:130%">int&nbsp;parent[MAXSIZE][COL],&nbsp;MAXV[MAXSIZE][COL],&nbsp;MINV[MAXSIZE][COL];</div><div style="padding:0 6px; white-space:pre; line-height:130%">int&nbsp;depth[MAXSIZE],&nbsp;n;</div><div style="padding:0 6px; white-space:pre; line-height:130%">vector<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>pv<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;node[MAXSIZE];</div><div style="padding:0 6px; white-space:pre; line-height:130%">bool&nbsp;chk[MAXSIZE];</div><div style="padding:0 6px; white-space:pre; line-height:130%">int&nbsp;ans_min,&nbsp;ans_max;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#919191">//바로&nbsp;위에&nbsp;있는&nbsp;부모와&nbsp;연결</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">void&nbsp;dfs(int&nbsp;cur,&nbsp;int&nbsp;d)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;chk[cur]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">true</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;depth[cur]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;d;&nbsp;<span style="color:#919191">//깊이</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">0</span>;&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>&nbsp;node[cur].size();&nbsp;i<span style="color:#F1F2F3"></span><span style="color:#93C763">+</span><span style="color:#F1F2F3"></span><span style="color:#93C763">+</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;next&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;node[cur][i].p;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(chk[next])&nbsp;continue;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent[next][<span style="color:#FFCD22">0</span>]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;cur;&nbsp;<span style="color:#919191">//next의&nbsp;1(2^0)번째&nbsp;부모는&nbsp;cur</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXV[next][<span style="color:#FFCD22">0</span>]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;node[cur][i].v;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MINV[next][<span style="color:#FFCD22">0</span>]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;node[cur][i].v;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dfs(next,&nbsp;d&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">+</span>&nbsp;<span style="color:#FFCD22">1</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">void&nbsp;makeTree()&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;dfs(<span style="color:#FFCD22">1</span>,&nbsp;<span style="color:#FFCD22">0</span>);&nbsp;<span style="color:#919191">//루트가&nbsp;1</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//노드&nbsp;u(1~n)의&nbsp;부모를&nbsp;연결하기</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;k&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">1</span>;&nbsp;k&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>&nbsp;COL;&nbsp;k<span style="color:#F1F2F3"></span><span style="color:#93C763">+</span><span style="color:#F1F2F3"></span><span style="color:#93C763">+</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;u&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">1</span>;&nbsp;u&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;n;&nbsp;u<span style="color:#F1F2F3"></span><span style="color:#93C763">+</span><span style="color:#F1F2F3"></span><span style="color:#93C763">+</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXV[u][k]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;max(MAXV[u][k&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>&nbsp;<span style="color:#FFCD22">1</span>],&nbsp;MAXV[parent[u][k&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>&nbsp;<span style="color:#FFCD22">1</span>]][k&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>&nbsp;<span style="color:#FFCD22">1</span>]);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MINV[u][k]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;min(MINV[u][k&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>&nbsp;<span style="color:#FFCD22">1</span>],&nbsp;MINV[parent[u][k&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>&nbsp;<span style="color:#FFCD22">1</span>]][k&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>&nbsp;<span style="color:#FFCD22">1</span>]);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent[u][k]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;parent[parent[u][k&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>&nbsp;<span style="color:#FFCD22">1</span>]][k&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>&nbsp;<span style="color:#FFCD22">1</span>];</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#919191">//최소&nbsp;공통&nbsp;조상&nbsp;찾기</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">void&nbsp;LCA(int&nbsp;a,&nbsp;int&nbsp;b)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//깊은쪽을&nbsp;b로&nbsp;설정해주고&nbsp;시작</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(depth[a]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;depth[b])&nbsp;swap(a,&nbsp;b);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;ans_max&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;MAXV[b][<span style="color:#FFCD22">0</span>];&nbsp;ans_min&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;MINV[b][<span style="color:#FFCD22">0</span>];</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//깊이가&nbsp;다른&nbsp;만큼&nbsp;맞춰주기</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;COL&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>&nbsp;<span style="color:#FFCD22">1</span>;&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">0</span>;&nbsp;i<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span><span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(depth[a]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;depth[parent[b][i]])&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans_max&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;max(ans_max,&nbsp;MAXV[b][i]);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans_min&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;min(ans_min,&nbsp;MINV[b][i]);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;parent[b][i];</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//a와&nbsp;b가&nbsp;같다면&nbsp;-&gt;&nbsp;최소&nbsp;공통&nbsp;조상</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(a&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span><span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;b)&nbsp;return;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//조상이&nbsp;같아질&nbsp;때까지&nbsp;업데이트</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;COL&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>&nbsp;<span style="color:#FFCD22">1</span>;&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">0</span>;&nbsp;i<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span><span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(parent[a][i]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">!</span><span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;parent[b][i])&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans_max&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;max(ans_max,&nbsp;max(MAXV[a][i],&nbsp;MAXV[b][i]));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans_min&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;min(ans_min,&nbsp;min(MINV[a][i],&nbsp;MINV[b][i]));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;parent[a][i];</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;parent[b][i];</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;ans_max&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;max(ans_max,&nbsp;max(MAXV[a][<span style="color:#FFCD22">0</span>],&nbsp;MAXV[b][<span style="color:#FFCD22">0</span>]));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;ans_min&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;min(ans_min,&nbsp;min(MINV[a][<span style="color:#FFCD22">0</span>],&nbsp;MINV[b][<span style="color:#FFCD22">0</span>]));</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">int&nbsp;main()&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;cin.tie(nullptr);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;cout.tie(NULL);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;ios_base::sync_with_stdio(<span style="color:#FFCD22">false</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//초기화</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;memset(depth,&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span><span style="color:#FFCD22">1</span>,&nbsp;sizeof(depth));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">0</span>;&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>&nbsp;MAXSIZE;&nbsp;i<span style="color:#F1F2F3"></span><span style="color:#93C763">+</span><span style="color:#F1F2F3"></span><span style="color:#93C763">+</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;j&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">0</span>;&nbsp;j&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>&nbsp;COL;&nbsp;j<span style="color:#F1F2F3"></span><span style="color:#93C763">+</span><span style="color:#F1F2F3"></span><span style="color:#93C763">+</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MINV[i][j]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;INF;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//input</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;cin&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;n;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">0</span>;&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>&nbsp;n&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>&nbsp;<span style="color:#FFCD22">1</span>;&nbsp;i<span style="color:#F1F2F3"></span><span style="color:#93C763">+</span><span style="color:#F1F2F3"></span><span style="color:#93C763">+</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;p,&nbsp;c,&nbsp;val;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cin&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;p&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;c&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;val;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node[c].push_back({&nbsp;p,&nbsp;val&nbsp;});</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node[p].push_back({&nbsp;c,&nbsp;val&nbsp;});</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;makeTree();</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;m;&nbsp;cin&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;m;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(m<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span><span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;a,&nbsp;b;&nbsp;cin&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;a&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;b;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCA(a,&nbsp;b);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>&nbsp;ans_min&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>&nbsp;<span style="color:#EC7600">"&nbsp;"</span>&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>&nbsp;ans_max&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>&nbsp;<span style="color:#EC7600">'\n'</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span style="color:#FFCD22">0</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4ftext-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
<br/>

### review
N개의 도시가 있고 이 도시들을 연결하는 도로가 N-1개다.<br>
모든 도시의 쌍에는 그 도시를 연결하는 유일한 쌍이 있다고 하니 트리 구조로 보면 되겠다.<br>
유일한 쌍이 존재하고 이에 접근하는 경로 중 도로의 길이를 체크하므로 LCA를 찾아 접근한다.<br>
'두 도시를 연결하는 경로 상에서 가장 짧은 도로의 길이와 가장 긴 도로의 길이를 구하라'라고 했는데<br>
이 부분을 잘못 이해해서 한참 걸렸다. 두 노드에서 시작하고 LCA까지 가는데 있는 각 도로별 길이 중에<br>
최솟값, 최댓값을 골라주면 된다. 간선 중에 답이 존재한다!<br>
<br>
처음에 트리라는건 생각했으나 TC에서 1, 2를 입력했는데 50, 100이 나오는걸 보고 당황했었다.<br>
루트 노드를 어디로 잡아도 상관없지만 1이라고 가정하면 노드 1, 2의 LCA는 1이 된다.<br>
그럼 1에서 1로 가는건 길이가 0이지만 여기서는 같은 노드로 이동하는건 카운트하지 않는걸로 판단된다.<br>
2에서 1로 갈 때 거리를 나타내면 2->3이 100, 3->1이 50이므로 답은 50, 100이 된다.<br>
혹시 이 글을 읽는 분들이라면 나처럼 헷갈려하지 않았으면 좋겠다.<br>
```
TC :
5
2 3 100
4 3 200
1 5 150
1 3 50
...
```
각 노드에서 LCA로 달려가는데 높이를 한 칸씩 올리면서 접근하면 당연히 시간 초과에 걸리게 된다.<br>
때문에 sparse table을 사용해 접근해서 로그 시간에 접근할 수 있도록 해야한다.<br>
최솟값, 최댓값을 저장하는 테이블은 부모를 저장하는 parent[][]에 자료형을 달리해서 저장하는 것도 방법이다.<br>
하지만 그렇게 할 경우 헷갈릴 것 같아서 MINV[][], MAXV[][]를 따로 만들어서 저장해줬다. parent와 같은 구조다!<br>
<br>
처음에 도로별 길이를 저장하는데 나같은 경우 부모를 설정해주기 전에(dfs()에 들어가기 전에) 처리해서 문제가 됐다.<br>
```
//input
cin >> n;
for (int i = 0; i < n - 1; i++) {
    int p, c, val;
    cin >> p >> c >> val;
    node[c].push_back(p);
    node[p].push_back(c);
    MAXV[b][0] = MINV[b][0] = val;  //이렇게 하지
    MAXV[c][0] = MINV[c][0] = val;  //마세요
}
```
나같은 경우 dfs(root, 0)에서 root를 인자에 넣어주고 재귀를 통해 부모를 연결하도록 해줬다.<br>
근데 이렇게 루트 노드가 정해지지 않은 상태에서 막 넣어버리면 MAXV[root][0], MINV[root][0]에 값이 들어간다.<br>
그럼 makeTree()에서 for문을 돌면서 다른 노드의 MAXV, MINV 값에 영향을 미치게 된다. 이런 일이 있으면 안된다.<br>
코드를 어떻게 짜느냐에 따라서 달라지므로 쓰지말라고 못박기는 그렇지만, 루트가 정해지기 전에 저장되면 안된다.<br>
```
//바로 위에 있는 부모와 연결
void dfs(int cur, int d) {
    chk[cur] = true;
    depth[cur] = d; //깊이
    for (int i = 0; i < node[cur].size(); i++) {
        int next = node[cur][i].p;
        if (chk[next]) continue;
        parent[next][0] = cur; //next의 1(2^0)번째 부모는 cur
        MAXV[next][0] = node[cur][i].v; //이렇게
        MINV[next][0] = node[cur][i].v; //처리했습니다!
        dfs(next, d + 1);
    }
}
```
그럼 dfs()를 나오고 makeTree()의 for문으로 들어간다. sparse table을 구현해봤다면 쉽게 이해할 수 있다.<br>
parent[u][k]는 u의 2^k번째 부모를 말한다. 설명은 [여기](http://blog.naver.com/PostView.nhn?blogId=kks227&logNo=220820773477)를 참고.<br>
dfs()에서 바로 윗 부모를 루트를 제외한 모든 노드에 연결시켜줬다.<br>
처음엔 k=1일 때 모든 노드를 돌면서 dfs()에서 얻은 @@@[u][0]을 가지고 @@@[u][1]을 업데이트 해준다.<br>
차례대로 k가 증가하면서 뒤에 있는 범위까지 업데이트 되는걸 알 수 있다.<br>
```
void makeTree() {
    dfs(1, 0); //루트가 1

    //노드 u(1~n)의 부모를 연결하기
    for (int k = 1; k < COL; k++) {
        for (int u = 1; u <= n; u++) {
            MAXV[u][k] = max(MAXV[u][k - 1], MAXV[parent[u][k - 1]][k - 1]);
            MINV[u][k] = min(MINV[u][k - 1], MINV[parent[u][k - 1]][k - 1]);
            parent[u][k] = parent[parent[u][k - 1]][k - 1];
        }
    }
}
```
여기까지 MAXV, MINV를 필요한 만큼 업데이트 해줬다. 이제 두 노드를 입력받고 LCA로 접근해가면 된다.<br>
MAXV, MINV가 sparse table이므로 LCA()에서도 부모까지 접근하는데 익숙한 방법을 사용한다.<br>
대신 부모로 접근하면서 ans_max, ans_min을 계속 업데이트해줘야 답을 얻을 수 있다.<br>
```
//최소 공통 조상 찾기
void LCA(int a, int b) {
//깊은쪽을 b로 설정해주고 시작
if (depth[a] > depth[b]) swap(a, b);

//깊은쪽이 b이므로 b의 값을 기준으로 초기화 해줘야 합니다
//a와 b의 깊이 차이가 1인 경우를 생각해보세요
ans_max = MAXV[b][0]; ans_min = MINV[b][0];

//깊이가 다른 만큼 맞춰주기
for (int i = COL - 1; i >= 0; i--) {
    if (depth[a] <= depth[parent[b][i]]) {
        ans_max = max(ans_max, MAXV[b][i]); //언급한
        ans_min = min(ans_min, MINV[b][i]); //부분입니다
        b = parent[b][i];
    }
}
...

첫 번째 for문을 지나면 a와 b가 같아질 수 있는데 b를 업데이트한 후 ans를 업데이트하면 잘못된 답을 반환합니다.
때문에 b를 업데이트하기 전에 ans를 업데이트해줘야 합니다.
```
두번째 for문에서는 LCA 바로 아래에서 a와 b가 멈추도록 설정했으므로 위와 다르게 설정해준다.<br>
```
//조상이 같아질 때까지 업데이트
for (int i = COL - 1; i >= 0; i--) {
    if (parent[a][i] != parent[b][i]) {
        ans_max = max(ans_max, max(MAXV[a][i], MAXV[b][i]));
        ans_min = min(ans_min, min(MINV[a][i], MINV[b][i]));
        a = parent[a][i];
        b = parent[b][i];
    }
}

ans_max = max(ans_max, max(MAXV[a][0], MAXV[b][0]));
ans_min = min(ans_min, min(MINV[a][0], MINV[b][0]));
```

<script src="https://utteranc.es/client.js"
        repo="yooniversal/blog-comments"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
