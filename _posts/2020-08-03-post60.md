---
layout: post
title:  "[BOJ 3584]"
date:   2020-08-03
excerpt: "가장 가까운 공통 조상"
categories: PS
image: "/images/3584.png"
sitemap :
  changefreq : weekly
  priority : 1.0
---
문제 바로가기 : [https://www.acmicpc.net/problem/3584](https://www.acmicpc.net/problem/3584)<br>
문제 설명은 위 링크에서 확인해주시길 바랍니다.
<br>
## Solution
<div class="colorscripter-code" style="color:#F1F2F3;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#22282A;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #4f4f4f"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#aaa;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div><div style="line-height:130%">30</div><div style="line-height:130%">31</div><div style="line-height:130%">32</div><div style="line-height:130%">33</div><div style="line-height:130%">34</div><div style="line-height:130%">35</div><div style="line-height:130%">36</div><div style="line-height:130%">37</div><div style="line-height:130%">38</div><div style="line-height:130%">39</div><div style="line-height:130%">40</div><div style="line-height:130%">41</div><div style="line-height:130%">42</div><div style="line-height:130%">43</div><div style="line-height:130%">44</div><div style="line-height:130%">45</div><div style="line-height:130%">46</div><div style="line-height:130%">47</div><div style="line-height:130%">48</div><div style="line-height:130%">49</div><div style="line-height:130%">50</div><div style="line-height:130%">51</div><div style="line-height:130%">52</div><div style="line-height:130%">53</div><div style="line-height:130%">54</div><div style="line-height:130%">55</div><div style="line-height:130%">56</div><div style="line-height:130%">57</div><div style="line-height:130%">58</div><div style="line-height:130%">59</div><div style="line-height:130%">60</div><div style="line-height:130%">61</div><div style="line-height:130%">62</div><div style="line-height:130%">63</div><div style="line-height:130%">64</div><div style="line-height:130%">65</div><div style="line-height:130%">66</div><div style="line-height:130%">67</div><div style="line-height:130%">68</div><div style="line-height:130%">69</div><div style="line-height:130%">70</div><div style="line-height:130%">71</div><div style="line-height:130%">72</div><div style="line-height:130%">73</div><div style="line-height:130%">74</div><div style="line-height:130%">75</div><div style="line-height:130%">76</div><div style="line-height:130%">77</div><div style="line-height:130%">78</div><div style="line-height:130%">79</div><div style="line-height:130%">80</div><div style="line-height:130%">81</div><div style="line-height:130%">82</div><div style="line-height:130%">83</div><div style="line-height:130%">84</div><div style="line-height:130%">85</div><div style="line-height:130%">86</div><div style="line-height:130%">87</div><div style="line-height:130%">88</div><div style="line-height:130%">89</div><div style="line-height:130%">90</div><div style="line-height:130%">91</div><div style="line-height:130%">92</div><div style="line-height:130%">93</div><div style="line-height:130%">94</div><div style="line-height:130%">95</div><div style="line-height:130%">96</div><div style="line-height:130%">97</div><div style="line-height:130%">98</div><div style="line-height:130%">99</div><div style="line-height:130%">100</div><div style="line-height:130%">101</div><div style="line-height:130%">102</div><div style="line-height:130%">103</div><div style="line-height:130%">104</div><div style="line-height:130%">105</div><div style="line-height:130%">106</div><div style="line-height:130%">107</div><div style="line-height:130%">108</div><div style="line-height:130%">109</div><div style="line-height:130%">110</div><div style="line-height:130%">111</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#F1F2F3;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#919191">//3584</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">#include&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>iostream<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">#include&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>string<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">#include&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>cstring<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">#include&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>cstdio<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">#include&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>vector<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">using&nbsp;namespace&nbsp;std;</div><div style="padding:0 6px; white-space:pre; line-height:130%">#define&nbsp;MAXSIZE&nbsp;<span style="color:#FFCD22">10005</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">#define&nbsp;COL&nbsp;<span style="color:#FFCD22">20</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">typedef&nbsp;long&nbsp;long&nbsp;ll;</div><div style="padding:0 6px; white-space:pre; line-height:130%">int&nbsp;parent[MAXSIZE][COL];</div><div style="padding:0 6px; white-space:pre; line-height:130%">int&nbsp;depth[MAXSIZE],&nbsp;root,&nbsp;n;</div><div style="padding:0 6px; white-space:pre; line-height:130%">vector<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>int<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;node[MAXSIZE];</div><div style="padding:0 6px; white-space:pre; line-height:130%">bool&nbsp;chk[MAXSIZE],&nbsp;whoroot[MAXSIZE];</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#919191">//초기화</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">void&nbsp;init()&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;memset(parent,&nbsp;<span style="color:#FFCD22">0</span>,&nbsp;sizeof(parent));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;memset(depth,&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span><span style="color:#FFCD22">1</span>,&nbsp;sizeof(depth));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;memset(chk,&nbsp;<span style="color:#FFCD22">false</span>,&nbsp;sizeof(chk));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;memset(whoroot,&nbsp;<span style="color:#FFCD22">true</span>,&nbsp;sizeof(whoroot));</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">1</span>;&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;n;&nbsp;i<span style="color:#F1F2F3"></span><span style="color:#93C763">+</span><span style="color:#F1F2F3"></span><span style="color:#93C763">+</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node[i].clear();</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#919191">//바로&nbsp;위에&nbsp;있는&nbsp;부모와&nbsp;연결</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">void&nbsp;dfs(int&nbsp;cur,&nbsp;int&nbsp;d)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;chk[cur]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">true</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;depth[cur]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;d;&nbsp;<span style="color:#919191">//깊이</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(auto<span style="color:#F1F2F3"></span><span style="color:#93C763">&amp;</span>&nbsp;next&nbsp;:&nbsp;node[cur])&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(chk[next])&nbsp;continue;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent[next][<span style="color:#FFCD22">0</span>]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;cur;&nbsp;<span style="color:#919191">//next의&nbsp;1(2^0)번째&nbsp;부모는&nbsp;cur</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dfs(next,&nbsp;d&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">+</span>&nbsp;<span style="color:#FFCD22">1</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">void&nbsp;makeTree()&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;dfs(root,&nbsp;<span style="color:#FFCD22">0</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//노드&nbsp;u(1~n)의&nbsp;부모를&nbsp;연결하기</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;k&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">1</span>;&nbsp;k&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>&nbsp;COL;&nbsp;k<span style="color:#F1F2F3"></span><span style="color:#93C763">+</span><span style="color:#F1F2F3"></span><span style="color:#93C763">+</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;u&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">1</span>;&nbsp;u&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;n;&nbsp;u<span style="color:#F1F2F3"></span><span style="color:#93C763">+</span><span style="color:#F1F2F3"></span><span style="color:#93C763">+</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent[u][k]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;parent[parent[u][k&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>&nbsp;<span style="color:#FFCD22">1</span>]][k&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>&nbsp;<span style="color:#FFCD22">1</span>];</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#919191">//최소&nbsp;공통&nbsp;조상&nbsp;찾기</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">int&nbsp;LCA(int&nbsp;a,&nbsp;int&nbsp;b)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//깊은쪽을&nbsp;b로&nbsp;설정해주고&nbsp;시작</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(depth[a]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;depth[b])&nbsp;swap(a,&nbsp;b);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//깊이가&nbsp;다른&nbsp;만큼&nbsp;맞춰주기</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//b의&nbsp;2^i번째&nbsp;조상이&nbsp;a의&nbsp;깊이보다&nbsp;크거나&nbsp;같으면&nbsp;업데이트</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;COL<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span><span style="color:#FFCD22">1</span>;&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">0</span>;&nbsp;i<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span><span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(depth[a]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;depth[parent[b][i]])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;parent[b][i];</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//a와&nbsp;b가&nbsp;같다면&nbsp;-&gt;&nbsp;최소&nbsp;공통&nbsp;조상</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(a&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span><span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;b)&nbsp;return&nbsp;a;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//조상이&nbsp;같아질&nbsp;때까지&nbsp;업데이트</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;COL<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span><span style="color:#FFCD22">1</span>;&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">0</span>;&nbsp;i<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span><span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(parent[a][i]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">!</span><span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;parent[b][i])&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;parent[a][i];</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;parent[b][i];</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;parent[a][<span style="color:#FFCD22">0</span>];</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">int&nbsp;main()&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;cin.tie(nullptr);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;cout.tie(NULL);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;ios_base::sync_with_stdio(<span style="color:#FFCD22">false</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;t;&nbsp;cin&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;t;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(t<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span><span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;init();</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cin&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;n;&nbsp;<span style="color:#919191">//노드&nbsp;개수</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//간선</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">0</span>;&nbsp;i&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>&nbsp;n&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">-</span>&nbsp;<span style="color:#FFCD22">1</span>;&nbsp;i<span style="color:#F1F2F3"></span><span style="color:#93C763">+</span><span style="color:#F1F2F3"></span><span style="color:#93C763">+</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;p,&nbsp;c;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cin&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;p&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;c;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node[c].push_back(p);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node[p].push_back(c);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whoroot[c]&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;<span style="color:#FFCD22">false</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//루트&nbsp;찾기</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span><span style="color:#FFCD22">1</span>;&nbsp;i<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>n;&nbsp;i<span style="color:#F1F2F3"></span><span style="color:#93C763">+</span><span style="color:#F1F2F3"></span><span style="color:#93C763">+</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(whoroot[i])&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">=</span>&nbsp;i;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;makeTree();</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#919191">//target</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;a,&nbsp;b;&nbsp;cin&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;a&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&gt;</span>&nbsp;b;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>&nbsp;LCA(a,&nbsp;b)&nbsp;<span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span><span style="color:#F1F2F3"></span><span style="color:#93C763">&lt;</span>&nbsp;<span style="color:#EC7600">'\n'</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span style="color:#FFCD22">0</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4ftext-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
<br/>

### LCA(lowest common ancestor)
LCA 알고리즘에 관해서는 [이곳](http://blog.naver.com/PostView.nhn?blogId=kks227&logNo=220820773477)에서 많은 도움을 받았습니다. 감사합니다.<br>
자세하게 설명돼있으니 참고하시길 권합니다.<br>
<br>
직역하면 최소 공통 조상. 두 노드를 찍고 조상으로 거슬러 올라갈 때 가장 빨리 만나는 노드를 찾는 알고리즘이다.<br>
DP도 DP지만 특정 노드에서 2^k번째에 있는 부모로 바로 이동할 수 있다는 장점을 지녔다. 시간복잡도가 크게 감소한다.<br>
핵심이 되는 점화식은 <strong>parent[u][k+1] = parent[parent[u][k]][k]</strong> 이다.<br>
u의 2^(k+1)번째에 있는 부모는 parent[u][k](u의 2^k번째 부모)의 k번째에 있는 부모를 뜻한다.<br>
조금 놀랍기도 하고 바로 와닿지 않을 수 있는 부분이라고 생각한다. 위 링크에서 자세하게 설명 돼있다!<br>

### review
input을 통해 이웃 노드를 추가시켜준 후 makeTree()에 속한 dfs()에서 각 노드당 1번째 부모를 갱신한다.<br>
그리고 각 노드의 depth도 갱신해주자. 이 depth는 나중에 LCA를 찾는데 중요한 역할을 한다.<br>
dfs()가 끝나면 1번째 뿐만 아니라 2^k번째(1, 2, 4...) 부모도 갱신해준다.<br>
```
//바로 위에 있는 부모와 연결
void dfs(int cur, int d) {
    chk[cur] = true;
    depth[cur] = d; //깊이
    for (auto& next : node[cur]) {
        if (chk[next]) continue;
        parent[next][0] = cur; //next의 1(2^0)번째 부모는 cur
        dfs(next, d + 1);
    }
}

void makeTree() {
    dfs(root, 0);

    //노드 u(1~n)의 부모를 연결하기
    for (int k = 1; k < COL; k++) {
        for (int u = 1; u <= n; u++) {
            parent[u][k] = parent[parent[u][k - 1]][k - 1];
        }
    }
}
```
2^k번만 갱신해주면 3, 5, 6..번째 부모는 어떻게 접근하는걸까 싶었는데 생각보다 간단했다.<br>
u에서 3번째 부모를 찾기위해 먼저 parent[u][1]로 이동하자. u의 2(2^1)번째 부모이고 이를 v라 하자.<br>
그리고 v의 1번째 부모로 이동하면 되므로 u의 3번째 부모는 parent[v][0]가 된다.<br>
<br>
또 다른 예를 들자면 모든 10진수는 2진법으로 나타낼 수 있다.<br>
10진수에서 가장 큰 10의 자릿수를 맨 앞에 놓는 것처럼 2도 마찬가지다.<br>
그렇게 앞에서부터 뒤로 쭉 채워나가면 2진법이 완성된다. 위의 3은 2진법으로 나타내면 11이다.<br>
처음에 2^1로 이동했고, 그 다음에 2^0번 이동했으니 2진법으로 나타내면 (2^1) * 1 + (2^0) * 1 = 11이 되겠다.<br>
<br>
모든 10진수를 2진법으로 나타낼 수 있다는건 <strong>2^k번째 부모의 정보만 갖고 있어도 어느 부모에나 접근할 수 있다</strong>는걸 말한다!<br>
처음 볼 때 계속 2^k가 등장해서 생소해가지고 이해하기 어려웠는데.. 잘 이해됐음 좋겠다.<br>
<br>
여기까지 트리를 완성했다. 그럼 이 트리에서 LCA를 찾아주면 된다.<br>
두 노드(a, b)의 depth가 같을 때 depth를 계속 올려준다. 이 때 a, b의 부모가 같으면 답이다.<br>
근데 a, b의 depth가 같다는 보장이 없다. 때문에 a, b의 depth를 같을 때까지 위치를 수정해줘야 한다.<br>
b가 있는 경로(parent[b][])에서 depth[a]와 같은 depth에 있는 위치까지 달려가면 된다!<br>
(여기서 a, b중 깊은 쪽에 있는건 b로 설정이 된 상태이다)
```
//깊이가 다른 만큼 맞춰주기
//b의 2^i번째 조상이 a의 깊이보다 크거나 같으면 업데이트
for (int i = COL-1; i >= 0; i--) {
    if (depth[a] <= depth[parent[b][i]])
        b = parent[b][i];
}
```
이렇게 달려갔는데 만약 b의 경로에서 a가 있었다면 depth가 같으므로 a==b가 된다.<br>
그럼 공통 조상은 a or b가 되므로 바로 리턴해준다.<br>
```
//a와 b가 같다면 -> 최소 공통 조상
if (a == b) return a;
```
이제 다른 경로에 있다면 원래 계획대로 같은 조상을 만날 때까지 같이 움직이면 된다.<br>
노드 밖의 범위 밖의 parent[][]는 모두 0으로 초기화 돼있어서 if절에서 false가 된다. (0 != 0)<br>
그럼 최종적으로 a, b는 LCA 바로 아래의 자식으로 이동하게 된다. 그럼 1번째 부모를 반환하자.<br>
```
//조상이 같아질 때까지 업데이트
for (int i = COL-1; i >= 0; i--) {
    if (parent[a][i] != parent[b][i]) {
        a = parent[a][i];
        b = parent[b][i];
    }
}

return parent[a][0];
```
<br>
![3584_2.png](/images/3584_2.png){: width="100%" height="100%"}
새로운걸 배운다는 생각에 기분이 좀 들떴었는데..<br>
초기화를 잘못해서, 범위를 잘못 설정해서 잡쳤다. 나름 신중하게 수정하고 제출했는데 속상하다.<br>
비도 쏟아지고 술이나 마시고 싶다.

<script src="https://utteranc.es/client.js"
        repo="yooniversal/blog-comments"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
